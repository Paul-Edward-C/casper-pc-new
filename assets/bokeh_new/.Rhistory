library(lubridate)
library(seasonal)
library(xts)
input_file <- '/Users/paul/Documents/Data/cn/cn_input/cn_tsf_nsa.csv'
output_file <- '/Users/paul/Documents/Data/cn/cn_input/cn_tsf_sa.csv'
df <- read.csv(input_file,
sep = ",",
na.strings = "NA",
strip.white = TRUE,
stringsAsFactors = FALSE)
df
# format as time series
df$Date <- as.Date(df$Date, format="%Y-%m-%d")
start_month <- month(df$Date[1])
start_year <- year(df$Date[1])
start_month
start_year
df_ts <- ts(df[-1],
start=c(start_year,start_month),
freq=12)
#seasonal adjustment
m <- seas(cbind(df_ts),
xreg = genhol(cny, start = 0, end = 0, center = "calendar"),
regression.aictest = "td",
x11 = "",
regression.usertype = "holiday"
)
#format final(m) to rename columns and format dates
df_sa <- as.xts(final(m))
names(df_sa)<-c(colnames(df)[-1]) #to name last three columns as same as original series
index(df_sa) <- as.Date(index(df_sa),
format="%b %Y")
write.csv(df_sa,output_file,
row.names = index(df_sa))
